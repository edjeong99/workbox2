<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<link rel="manifest" href="/manifest.json">
</head>
<body>
<input id="task"><button id="add">Add</button>
<hr>
<div id="todos"></div>
     <div id="installContainer" class="hidden">
      <button id="butInstall" type="button">
        Install this App
      </button>
    </div>


<script src="todo.js"></script>


  <script>
    if ('serviceWorker' in navigator) {
    ¬† window.addEventListener('load', () => {
    ¬† ¬† navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log(`Service Worker registered! Scope: ${registration.scope}`);
          })
          .catch(err => {
            console.log(`Service Worker registration failed: ${err}`);
          });
    ¬† });

    window.addEventListener('beforeinstallprompt', (event) => {
  console.log('üëç', 'beforeinstallprompt', event);
  // Stash the event so it can be triggered later.
  window.deferredPrompt = event;
  // Remove the 'hidden' class from the install button container
  divInstall.classList.toggle('hidden', false);

window.addEventListener('appinstalled', (event) => {
  console.log('üëç', 'appinstalled', event);
});


  butInstall.addEventListener('click', () => {
  console.log('üëç', 'butInstall-clicked');
  const promptEvent = window.deferredPrompt;
  if (!promptEvent) {
    // The deferred prompt isn't available.
    return;
  }
  // Show the install prompt.
  promptEvent.prompt();
  // Log the result
  promptEvent.userChoice.then((result) => {
    console.log('üëç', 'userChoice', result);
    // Reset the deferred prompt variable, since
    // prompt() can only be called once.
    window.deferredPrompt = null;
    // Hide the install button.
    divInstall.classList.toggle('hidden', true);
  });
});
});
    }

   
  </script>
<script>
window.addEventListener('beforeinstallprompt', (e) => {
  // Prevent Chrome 67 and earlier from automatically showing the prompt
  e.preventDefault();
  // Stash the event so it can be triggered later.
  window.deferredPrompt = e;
    // Update UI notify the user they can install the PWA
  showInstallPromotion();
});
</script>

</body>
</html>
